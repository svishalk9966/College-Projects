<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskMarket - Freelance Task Management Platform</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
    
    <!-- DaisyUI -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.23/dist/full.min.css" rel="stylesheet" type="text/css" />
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); }
        .dark .glass { background: rgba(30, 41, 59, 0.7); }
        .gradient-text { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-slide-in { animation: slideIn 0.5s ease-out; }
        .skeleton { background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%); background-size: 200% 100%; animation: loading 1.5s infinite; }
        @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    </style>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#667eea',
                        secondary: '#764ba2',
                        accent: '#f093fb',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-base-100 text-base-content">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useContext, createContext, Suspense, lazy, useCallback, useMemo } = React;
        
        // ==========================================
        // MOCK FIREBASE SERVICES
        // ==========================================
        const mockFirebase = {
            auth: {
                currentUser: null,
                onAuthStateChanged: (callback) => {
                    const stored = localStorage.getItem('taskmarket_user');
                    if (stored) {
                        mockFirebase.auth.currentUser = JSON.parse(stored);
                        callback(JSON.parse(stored));
                    } else {
                        callback(null);
                    }
                    return () => {};
                },
                signInWithEmailAndPassword: async (email, password) => {
                    await new Promise(r => setTimeout(r, 800));
                    const users = JSON.parse(localStorage.getItem('taskmarket_users') || '[]');
                    const user = users.find(u => u.email === email && u.password === password);
                    if (!user) throw new Error('Invalid credentials');
                    mockFirebase.auth.currentUser = user;
                    localStorage.setItem('taskmarket_user', JSON.stringify(user));
                    return { user };
                },
                createUserWithEmailAndPassword: async (email, password, displayName) => {
                    await new Promise(r => setTimeout(r, 800));
                    const users = JSON.parse(localStorage.getItem('taskmarket_users') || '[]');
                    if (users.find(u => u.email === email)) throw new Error('Email already exists');
                    const newUser = {
                        uid: Date.now().toString(),
                        email,
                        displayName,
                        photoURL: `https://ui-avatars.com/api/?name=${encodeURIComponent(displayName)}&background=random`,
                        createdAt: new Date().toISOString(),
                        password // In real app, never store plain text
                    };
                    users.push(newUser);
                    localStorage.setItem('taskmarket_users', JSON.stringify(users));
                    mockFirebase.auth.currentUser = newUser;
                    localStorage.setItem('taskmarket_user', JSON.stringify(newUser));
                    return { user: newUser };
                },
                signOut: async () => {
                    await new Promise(r => setTimeout(r, 500));
                    mockFirebase.auth.currentUser = null;
                    localStorage.removeItem('taskmarket_user');
                },
                updateProfile: async (updates) => {
                    const user = JSON.parse(localStorage.getItem('taskmarket_user'));
                    Object.assign(user, updates);
                    localStorage.setItem('taskmarket_user', JSON.stringify(user));
                    mockFirebase.auth.currentUser = user;
                }
            },
            firestore: {
            collection: (name) => ({
                add: async (data) => {
                    await new Promise(r => setTimeout(r, 600));
                    try {
                        const items = JSON.parse(localStorage.getItem(`taskmarket_${name}`) || '[]');
                        const newItem = { 
                            id: Date.now().toString(), 
                            ...data, 
                            createdAt: new Date().toISOString(),
                            updatedAt: new Date().toISOString()
                        };
                        items.push(newItem);
                        localStorage.setItem(`taskmarket_${name}`, JSON.stringify(items));
                        return { id: newItem.id };
                    } catch (error) {
                        console.error('Error adding document:', error);
                        throw error;
                    }
                },
                    doc: (id) => ({
                        update: async (data) => {
                            await new Promise(r => setTimeout(r, 400));
                            const items = JSON.parse(localStorage.getItem(`taskmarket_${name}`) || '[]');
                            const idx = items.findIndex(i => i.id === id);
                            if (idx !== -1) {
                                items[idx] = { ...items[idx], ...data, updatedAt: new Date().toISOString() };
                                localStorage.setItem(`taskmarket_${name}`, JSON.stringify(items));
                            }
                        },
                        delete: async () => {
                            await new Promise(r => setTimeout(r, 400));
                            const items = JSON.parse(localStorage.getItem(`taskmarket_${name}`) || '[]');
                            const filtered = items.filter(i => i.id !== id);
                            localStorage.setItem(`taskmarket_${name}`, JSON.stringify(filtered));
                        }
                    }),
                    get: async () => {
                        await new Promise(r => setTimeout(r, 500));
                        return {
                            docs: JSON.parse(localStorage.getItem(`taskmarket_${name}`) || '[]').map(item => ({
                                id: item.id,
                                data: () => item,
                                exists: true
                            }))
                        };
                    },
                    where: (field, op, value) => ({
                        get: async () => {
                            await new Promise(r => setTimeout(r, 500));
                            const items = JSON.parse(localStorage.getItem(`taskmarket_${name}`) || '[]');
                            const filtered = items.filter(item => {
                                if (op === '==') return item[field] === value;
                                if (op === 'array-contains') return item[field]?.includes(value);
                                return true;
                            });
                            return {
                                docs: filtered.map(item => ({
                                    id: item.id,
                                    data: () => item,
                                    exists: true
                                }))
                            };
                        }
                    }),
                    orderBy: (field, dir) => ({
                        get: async () => {
                            await new Promise(r => setTimeout(r, 500));
                            const items = JSON.parse(localStorage.getItem(`taskmarket_${name}`) || '[]');
                            const sorted = [...items].sort((a, b) => {
                                if (dir === 'desc') return new Date(b[field]) - new Date(a[field]);
                                return new Date(a[field]) - new Date(b[field]);
                            });
                            return {
                                docs: sorted.map(item => ({
                                    id: item.id,
                                    data: () => item,
                                    exists: true
                                }))
                            };
                        }
                    })
                }),
                onSnapshot: (query, callback) => {
                    try {
                        const checkData = () => {
                            const items = JSON.parse(localStorage.getItem('taskmarket_tasks') || '[]');
                            if (callback && typeof callback === 'function') {
                                callback({
                                    docs: items.map(item => ({
                                        id: item.id,
                                        data: () => item
                                    })),
                                    size: items.length
                                });
                            }
                        };
                        checkData();
                        const interval = setInterval(checkData, 2000);
                        return () => clearInterval(interval);
                    } catch (error) {
                        console.error('Error in onSnapshot:', error);
                        return () => {};
                    }
                }
            }
        };

        // Initialize sample data if empty
        if (!localStorage.getItem('taskmarket_tasks')) {
            const sampleTasks = [
                {
                    id: '1',
                    title: 'Build E-commerce Website',
                    description: 'Need a full-stack developer to build a modern e-commerce platform with React and Node.js. Must include payment integration and admin dashboard.',
                    budget: 5000,
                    category: 'Web Development',
                    status: 'open',
                    postedBy: 'client@example.com',
                    postedByName: 'Sarah Johnson',
                    postedByPhoto: 'https://ui-avatars.com/api/?name=Sarah+Johnson&background=random',
                    createdAt: new Date(Date.now() - 86400000 * 2).toISOString(),
                    deadline: '2024-03-15',
                    skills: ['React', 'Node.js', 'MongoDB', 'Stripe'],
                    bids: [],
                    location: 'Remote'
                },
                {
                    id: '2',
                    title: 'Mobile App UI Design',
                    description: 'Looking for a talented UI/UX designer to create beautiful interfaces for a fitness tracking app. Must have experience with Figma and mobile design patterns.',
                    budget: 2500,
                    category: 'Design',
                    status: 'open',
                    postedBy: 'client2@example.com',
                    postedByName: 'Mike Chen',
                    postedByPhoto: 'https://ui-avatars.com/api/?name=Mike+Chen&background=random',
                    createdAt: new Date(Date.now() - 86400000).toISOString(),
                    deadline: '2024-02-28',
                    skills: ['Figma', 'UI Design', 'Mobile Design', 'Prototyping'],
                    bids: [],
                    location: 'Remote'
                },
                {
                    id: '3',
                    title: 'SEO Optimization for Blog',
                    description: 'Need SEO expert to optimize my tech blog for better search rankings. Current traffic is 10k/month, aiming for 50k/month.',
                    budget: 800,
                    category: 'Marketing',
                    status: 'in-progress',
                    postedBy: 'client3@example.com',
                    postedByName: 'Emma Davis',
                    postedByPhoto: 'https://ui-avatars.com/api/?name=Emma+Davis&background=random',
                    createdAt: new Date(Date.now() - 86400000 * 3).toISOString(),
                    deadline: '2024-02-20',
                    skills: ['SEO', 'Content Strategy', 'Google Analytics'],
                    bids: [{ freelancer: 'dev@example.com', amount: 750, message: 'I can help you achieve this goal' }],
                    location: 'Remote',
                    assignedTo: 'dev@example.com'
                }
            ];
            localStorage.setItem('taskmarket_tasks', JSON.stringify(sampleTasks));
        }

        // ==========================================
        // CONTEXTS
        // ==========================================
        const AuthContext = createContext(null);
        const ThemeContext = createContext(null);

        // ==========================================
        // COMPONENTS
        // ==========================================
        
        // Loading Spinner
        const LoadingSpinner = () => (
            <div className="flex items-center justify-center min-h-[200px]">
                <span className="loading loading-spinner loading-lg text-primary"></span>
            </div>
        );

        // Error Boundary
        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false };
            }
            static getDerivedStateFromError(error) {
                return { hasError: true };
            }
            componentDidCatch(error, errorInfo) {
                console.error('Error:', error, errorInfo);
            }
            render() {
                if (this.state.hasError) {
                    return (
                        <div className="min-h-screen flex items-center justify-center bg-base-200">
                            <div className="text-center">
                                <h2 className="text-2xl font-bold mb-4">Something went wrong</h2>
                                <button className="btn btn-primary" onClick={() => window.location.reload()}>
                                    Refresh Page
                                </button>
                            </div>
                        </div>
                    );
                }
                return this.props.children;
            }
        }

        // Auth Provider
        const AuthProvider = ({ children }) => {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                const unsubscribe = mockFirebase.auth.onAuthStateChanged((user) => {
                    setUser(user);
                    setLoading(false);
                });
                return unsubscribe;
            }, []);

            const login = async (email, password) => {
                const result = await mockFirebase.auth.signInWithEmailAndPassword(email, password);
                setUser(result.user);
                return result.user;
            };

            const signup = async (email, password, displayName) => {
                const result = await mockFirebase.auth.createUserWithEmailAndPassword(email, password, displayName);
                setUser(result.user);
                return result.user;
            };

            const logout = async () => {
                await mockFirebase.auth.signOut();
                setUser(null);
            };

            const value = {
                user,
                login,
                signup,
                logout,
                loading
            };

            return (
                <AuthContext.Provider value={value}>
                    {!loading && children}
                </AuthContext.Provider>
            );
        };

        const useAuth = () => {
            const context = useContext(AuthContext);
            if (!context) throw new Error('useAuth must be used within AuthProvider');
            return context;
        };

        // Theme Provider
        const ThemeProvider = ({ children }) => {
            const [theme, setTheme] = useState('light');

            useEffect(() => {
                const saved = localStorage.getItem('taskmarket_theme') || 'light';
                setTheme(saved);
                document.documentElement.setAttribute('data-theme', saved);
                if (saved === 'dark') document.documentElement.classList.add('dark');
            }, []);

            const toggleTheme = () => {
                const newTheme = theme === 'light' ? 'dark' : 'light';
                setTheme(newTheme);
                localStorage.setItem('taskmarket_theme', newTheme);
                document.documentElement.setAttribute('data-theme', newTheme);
                document.documentElement.classList.toggle('dark');
            };

            return (
                <ThemeContext.Provider value={{ theme, toggleTheme }}>
                    {children}
                </ThemeContext.Provider>
            );
        };

        const useTheme = () => useContext(ThemeContext);

        // Navigation
        const Navbar = () => {
            const { user, logout } = useAuth();
            const { theme, toggleTheme } = useTheme();
            const [isOpen, setIsOpen] = useState(false);

            return (
                <div className="navbar bg-base-100 shadow-lg sticky top-0 z-50 glass">
                    <div className="navbar-start">
                        <div className="dropdown lg:hidden">
                            <div tabIndex={0} role="button" className="btn btn-ghost btn-circle" onClick={() => setIsOpen(!isOpen)}>
                                <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16M4 18h7" />
                                </svg>
                            </div>
                        </div>
                        <a href="#" className="btn btn-ghost text-xl font-bold gap-2" onClick={() => window.navigateTo('home')}>
                            <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white font-bold">
                                T
                            </div>
                            TaskMarket
                        </a>
                    </div>
                    
                    <div className="navbar-center hidden lg:flex">
                        <ul className="menu menu-horizontal px-1 gap-2">
                            <li><a className="btn btn-ghost" onClick={() => window.navigateTo('home')}>Home</a></li>
                            <li><a className="btn btn-ghost" onClick={() => window.navigateTo('browse')}>Browse Tasks</a></li>
                            {user && (
                                <>
                                    <li><a className="btn btn-ghost" onClick={() => window.navigateTo('dashboard')}>Dashboard</a></li>
                                    <li><a className="btn btn-ghost" onClick={() => window.navigateTo('post')}>Post Task</a></li>
                                </>
                            )}
                        </ul>
                    </div>

                    <div className="navbar-end gap-2">
                        <button className="btn btn-ghost btn-circle" onClick={toggleTheme}>
                            {theme === 'light' ? (
                                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                            ) : (
                                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                            )}
                        </button>
                        
                        {user ? (
                            <div className="dropdown dropdown-end">
                                <div tabIndex={0} role="button" className="btn btn-ghost btn-circle avatar">
                                    <div className="w-10 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2">
                                        <img src={user.photoURL} alt={user.displayName} />
                                    </div>
                                </div>
                                <ul tabIndex={0} className="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-52">
                                    <li className="menu-title">{user.displayName}</li>
                                    <li><a onClick={() => window.navigateTo('dashboard')}>Dashboard</a></li>
                                    <li><a onClick={() => window.navigateTo('profile')}>Profile</a></li>
                                    <div className="divider my-1"></div>
                                    <li><a onClick={logout} className="text-error">Logout</a></li>
                                </ul>
                            </div>
                        ) : (
                            <div className="flex gap-2">
                                <button className="btn btn-ghost" onClick={() => window.navigateTo('login')}>Login</button>
                                <button className="btn btn-primary" onClick={() => window.navigateTo('signup')}>Sign Up</button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // Hero Section
        const Hero = () => {
            const stats = [
                { label: 'Active Tasks', value: '2,500+', icon: 'briefcase' },
                { label: 'Freelancers', value: '15,000+', icon: 'users' },
                { label: 'Completed', value: '8,200+', icon: 'check-circle' },
                { label: 'Categories', value: '50+', icon: 'grid' }
            ];

            return (
                <div className="relative overflow-hidden bg-base-100">
                    <div className="absolute inset-0 bg-gradient-to-br from-primary/10 to-secondary/10"></div>
                    <div className="container mx-auto px-4 py-20 relative z-10">
                        <div className="text-center max-w-4xl mx-auto animate-slide-in">
                            <div className="badge badge-primary badge-lg mb-4">üöÄ Launch Your Career</div>
                            <h1 className="text-5xl md:text-7xl font-bold mb-6 leading-tight">
                                Find Top Freelancers for <br/>
                                <span className="gradient-text">Any Task, Anytime</span>
                            </h1>
                            <p className="text-xl text-base-content/70 mb-8 max-w-2xl mx-auto">
                                Connect with skilled professionals worldwide. Post tasks, place bids, and get work done efficiently on the most intuitive freelance platform.
                            </p>
                            <div className="flex flex-col sm:flex-row gap-4 justify-center mb-12">
                                <button className="btn btn-primary btn-lg gap-2" onClick={() => window.navigateTo('browse')}>
                                    Find Work
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 8l4 4m0 0l-4 4m4-4H3" /></svg>
                                </button>
                                <button className="btn btn-outline btn-lg" onClick={() => window.navigateTo('post')}>
                                    Post a Task
                                </button>
                            </div>
                            
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-3xl mx-auto">
                                {stats.map((stat, idx) => (
                                    <div key={idx} className="bg-base-100/50 backdrop-blur p-4 rounded-xl border border-base-200">
                                        <div className="text-2xl font-bold text-primary">{stat.value}</div>
                                        <div className="text-sm text-base-content/60">{stat.label}</div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                    
                    <div className="absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-base-100 to-transparent"></div>
                </div>
            );
        };

        // Task Card
        const TaskCard = ({ task, onClick }) => {
            const statusColors = {
                open: 'badge-success',
                'in-progress': 'badge-warning',
                completed: 'badge-info',
                closed: 'badge-error'
            };

            return (
                <div className="card bg-base-100 shadow-xl card-hover border border-base-200 cursor-pointer" onClick={onClick}>
                    <div className="card-body">
                        <div className="flex justify-between items-start mb-2">
                            <div className="badge badge-outline">{task.category}</div>
                            <div className={`badge ${statusColors[task.status] || 'badge-ghost'} badge-sm`}>
                                {task.status.replace('-', ' ')}
                            </div>
                        </div>
                        
                        <h3 className="card-title text-lg mb-2 line-clamp-2">{task.title}</h3>
                        <p className="text-base-content/70 text-sm mb-4 line-clamp-2">{task.description}</p>
                        
                        <div className="flex flex-wrap gap-2 mb-4">
                            {task.skills?.slice(0, 3).map((skill, idx) => (
                                <span key={idx} className="badge badge-ghost badge-sm">{skill}</span>
                            ))}
                            {task.skills?.length > 3 && (
                                <span className="badge badge-ghost badge-sm">+{task.skills.length - 3}</span>
                            )}
                        </div>
                        
                        <div className="flex items-center justify-between pt-4 border-t border-base-200">
                            <div className="flex items-center gap-2">
                                <div className="avatar">
                                    <div className="w-8 rounded-full">
                                        <img src={task.postedByPhoto} alt={task.postedByName} />
                                    </div>
                                </div>
                                <span className="text-sm font-medium">{task.postedByName}</span>
                            </div>
                            <div className="text-right">
                                <div className="text-lg font-bold text-primary">${task.budget.toLocaleString()}</div>
                                <div className="text-xs text-base-content/50">{task.bids?.length || 0} bids</div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Task Detail Modal
        const TaskDetailModal = ({ task, onClose, onPlaceBid }) => {
            const { user } = useAuth();
            const [bidAmount, setBidAmount] = useState('');
            const [bidMessage, setBidMessage] = useState('');
            const [showBidForm, setShowBidForm] = useState(false);

            if (!task) return null;

            const handleBid = async (e) => {
                e.preventDefault();
                if (!bidAmount || !bidMessage) return;
                
                await onPlaceBid(task.id, {
                    amount: parseInt(bidAmount),
                    message: bidMessage,
                    freelancer: user.email,
                    freelancerName: user.displayName,
                    freelancerPhoto: user.photoURL,
                    createdAt: new Date().toISOString()
                });
                
                setShowBidForm(false);
                setBidAmount('');
                setBidMessage('');
            };

            return (
                <dialog className="modal modal-open">
                    <div className="modal-box max-w-3xl">
                        <button className="btn btn-sm btn-circle btn-ghost absolute right-2 top-2" onClick={onClose}>‚úï</button>
                        
                        <div className="flex items-start justify-between mb-4">
                            <div>
                                <div className="badge badge-outline mb-2">{task.category}</div>
                                <h3 className="text-2xl font-bold">{task.title}</h3>
                            </div>
                            <div className="text-right">
                                <div className="text-3xl font-bold text-primary">${task.budget.toLocaleString()}</div>
                                <div className="text-sm text-base-content/50">Budget</div>
                            </div>
                        </div>

                        <div className="divider"></div>

                        <div className="space-y-4">
                            <div>
                                <h4 className="font-semibold mb-2">Description</h4>
                                <p className="text-base-content/80 whitespace-pre-wrap">{task.description}</p>
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                                <div className="bg-base-200 p-3 rounded-lg">
                                    <div className="text-sm text-base-content/60">Deadline</div>
                                    <div className="font-semibold">{new Date(task.deadline).toLocaleDateString()}</div>
                                </div>
                                <div className="bg-base-200 p-3 rounded-lg">
                                    <div className="text-sm text-base-content/60">Location</div>
                                    <div className="font-semibold">{task.location}</div>
                                </div>
                            </div>

                            <div>
                                <h4 className="font-semibold mb-2">Required Skills</h4>
                                <div className="flex flex-wrap gap-2">
                                    {task.skills?.map((skill, idx) => (
                                        <span key={idx} className="badge badge-primary badge-outline">{skill}</span>
                                    ))}
                                </div>
                            </div>

                            <div className="divider"></div>

                            <div className="flex items-center justify-between">
                                <div className="flex items-center gap-3">
                                    <div className="avatar">
                                        <div className="w-12 rounded-full">
                                            <img src={task.postedByPhoto} alt={task.postedByName} />
                                        </div>
                                    </div>
                                    <div>
                                        <div className="font-semibold">{task.postedByName}</div>
                                        <div className="text-sm text-base-content/60">Posted {new Date(task.createdAt).toLocaleDateString()}</div>
                                    </div>
                                </div>
                                
                                {user && user.email !== task.postedBy && task.status === 'open' && (
                                    <button 
                                        className="btn btn-primary"
                                        onClick={() => setShowBidForm(!showBidForm)}
                                    >
                                        {showBidForm ? 'Cancel' : 'Place Bid'}
                                    </button>
                                )}
                            </div>

                            {showBidForm && (
                                <form onSubmit={handleBid} className="bg-base-200 p-4 rounded-lg mt-4 animate-slide-in">
                                    <h4 className="font-semibold mb-3">Submit Your Proposal</h4>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                        <div className="form-control">
                                            <label className="label">
                                                <span className="label-text">Your Bid ($)</span>
                                            </label>
                                            <input 
                                                type="number" 
                                                className="input input-bordered" 
                                                value={bidAmount}
                                                onChange={(e) => setBidAmount(e.target.value)}
                                                placeholder="Enter amount"
                                                required
                                                min="1"
                                            />
                                        </div>
                                    </div>
                                    <div className="form-control mb-4">
                                        <label className="label">
                                            <span className="label-text">Cover Letter</span>
                                        </label>
                                        <textarea 
                                            className="textarea textarea-bordered h-24" 
                                            value={bidMessage}
                                            onChange={(e) => setBidMessage(e.target.value)}
                                            placeholder="Describe why you're perfect for this task..."
                                            required
                                        ></textarea>
                                    </div>
                                    <button type="submit" className="btn btn-primary w-full">Submit Bid</button>
                                </form>
                            )}

                            {task.bids?.length > 0 && (
                                <div className="mt-6">
                                    <h4 className="font-semibold mb-3">Current Bids ({task.bids.length})</h4>
                                    <div className="space-y-3">
                                        {task.bids.map((bid, idx) => (
                                            <div key={idx} className="flex items-center justify-between bg-base-200 p-3 rounded-lg">
                                                <div className="flex items-center gap-3">
                                                    <div className="avatar">
                                                        <div className="w-10 rounded-full">
                                                            <img src={bid.freelancerPhoto || `https://ui-avatars.com/api/?name=${encodeURIComponent(bid.freelancerName)}&background=random`} alt={bid.freelancerName} />
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <div className="font-medium">{bid.freelancerName}</div>
                                                        <div className="text-sm text-base-content/60 line-clamp-1">{bid.message}</div>
                                                    </div>
                                                </div>
                                                <div className="text-lg font-bold text-primary">${bid.amount}</div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                    <div className="modal-backdrop" onClick={onClose}></div>
                </dialog>
            );
        };

        // Browse Tasks Page
        const BrowseTasks = () => {
            const [tasks, setTasks] = useState([]);
            const [loading, setLoading] = useState(true);
            const [selectedTask, setSelectedTask] = useState(null);
            const [filter, setFilter] = useState('all');
            const [search, setSearch] = useState('');
            const { user } = useAuth();

            useEffect(() => {
                const unsubscribe = mockFirebase.firestore.onSnapshot(
                    mockFirebase.firestore.collection('tasks'),
                    (snapshot) => {
                        const taskList = snapshot.docs.map(doc => ({
                            id: doc.id,
                            ...doc.data()
                        }));
                        setTasks(taskList);
                        setLoading(false);
                    }
                );
                return () => unsubscribe();
            }, []);

            const handlePlaceBid = async (taskId, bidData) => {
                const task = tasks.find(t => t.id === taskId);
                const updatedBids = [...(task.bids || []), bidData];
                
                await mockFirebase.firestore.collection('tasks').doc(taskId).update({
                    bids: updatedBids
                });
                
                // Refresh tasks
                const snapshot = await mockFirebase.firestore.collection('tasks').get();
                setTasks(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
            };

            const filteredTasks = tasks.filter(task => {
                const matchesFilter = filter === 'all' || task.status === filter;
                const matchesSearch = task.title.toLowerCase().includes(search.toLowerCase()) || 
                                    task.description.toLowerCase().includes(search.toLowerCase());
                return matchesFilter && matchesSearch;
            });

            const categories = [...new Set(tasks.map(t => t.category))];

            if (loading) return <LoadingSpinner />;

            return (
                <div className="container mx-auto px-4 py-8 animate-slide-in">
                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
                        <div>
                            <h2 className="text-3xl font-bold mb-2">Browse Tasks</h2>
                            <p className="text-base-content/60">Find the perfect project for your skills</p>
                        </div>
                        <div className="flex gap-2">
                            <select 
                                className="select select-bordered"
                                value={filter}
                                onChange={(e) => setFilter(e.target.value)}
                            >
                                <option value="all">All Status</option>
                                <option value="open">Open</option>
                                <option value="in-progress">In Progress</option>
                                <option value="completed">Completed</option>
                            </select>
                        </div>
                    </div>

                    <div className="form-control mb-6">
                        <div className="input-group">
                            <input 
                                type="text" 
                                placeholder="Search tasks..." 
                                className="input input-bordered w-full"
                                value={search}
                                onChange={(e) => setSearch(e.target.value)}
                            />
                            <button className="btn btn-square btn-primary">
                                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                            </button>
                        </div>
                    </div>

                    <div className="flex gap-2 mb-6 overflow-x-auto pb-2">
                        <button 
                            className={`btn btn-sm ${filter === 'all' ? 'btn-primary' : 'btn-ghost'}`}
                            onClick={() => setFilter('all')}
                        >
                            All Categories
                        </button>
                        {categories.map(cat => (
                            <button 
                                key={cat}
                                className={`btn btn-sm ${filter === cat ? 'btn-primary' : 'btn-ghost'}`}
                                onClick={() => setFilter(cat)}
                            >
                                {cat}
                            </button>
                        ))}
                    </div>

                    {filteredTasks.length === 0 ? (
                        <div className="text-center py-20">
                            <div className="text-6xl mb-4">üîç</div>
                            <h3 className="text-xl font-semibold mb-2">No tasks found</h3>
                            <p className="text-base-content/60">Try adjusting your filters or search terms</p>
                        </div>
                    ) : (
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {filteredTasks.map(task => (
                                <TaskCard 
                                    key={task.id} 
                                    task={task} 
                                    onClick={() => setSelectedTask(task)}
                                />
                            ))}
                        </div>
                    )}

                    {selectedTask && (
                        <TaskDetailModal 
                            task={selectedTask} 
                            onClose={() => setSelectedTask(null)}
                            onPlaceBid={handlePlaceBid}
                        />
                    )}
                </div>
            );
        };

        // Dashboard Page
        const Dashboard = () => {
            const { user } = useAuth();
            const [activeTab, setActiveTab] = useState('posted');
            const [tasks, setTasks] = useState([]);
            const [bids, setBids] = useState([]);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                const fetchData = async () => {
                    const tasksSnapshot = await mockFirebase.firestore.collection('tasks').get();
                    const allTasks = tasksSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    
                    const myTasks = allTasks.filter(t => t.postedBy === user.email);
                    const myBids = allTasks.filter(t => 
                        t.bids?.some(b => b.freelancer === user.email)
                    );
                    
                    setTasks(myTasks);
                    setBids(myBids);
                    setLoading(false);
                };
                fetchData();
            }, [user]);

            const stats = {
                posted: tasks.length,
                active: tasks.filter(t => t.status === 'open').length,
                completed: tasks.filter(t => t.status === 'completed').length,
                totalSpent: tasks.filter(t => t.status === 'completed').reduce((acc, t) => acc + t.budget, 0)
            };

            if (loading) return <LoadingSpinner />;

            return (
                <div className="container mx-auto px-4 py-8 animate-slide-in">
                    <div className="flex items-center gap-4 mb-8">
                        <div className="avatar">
                            <div className="w-20 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2">
                                <img src={user.photoURL} alt={user.displayName} />
                            </div>
                        </div>
                        <div>
                            <h2 className="text-3xl font-bold">{user.displayName}</h2>
                            <p className="text-base-content/60">{user.email}</p>
                            <div className="flex gap-2 mt-2">
                                <div className="badge badge-primary">Client</div>
                                <div className="badge badge-secondary">Freelancer</div>
                            </div>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                        <div className="stat bg-base-200 rounded-box">
                            <div className="stat-title">Tasks Posted</div>
                            <div className="stat-value text-primary">{stats.posted}</div>
                        </div>
                        <div className="stat bg-base-200 rounded-box">
                            <div className="stat-title">Active Tasks</div>
                            <div className="stat-value text-secondary">{stats.active}</div>
                        </div>
                        <div className="stat bg-base-200 rounded-box">
                            <div className="stat-title">Completed</div>
                            <div className="stat-value text-accent">{stats.completed}</div>
                        </div>
                        <div className="stat bg-base-200 rounded-box">
                            <div className="stat-title">Total Spent</div>
                            <div className="stat-value text-success">${stats.totalSpent.toLocaleString()}</div>
                        </div>
                    </div>

                    <div className="tabs tabs-boxed mb-6">
                        <a 
                            className={`tab ${activeTab === 'posted' ? 'tab-active' : ''}`}
                            onClick={() => setActiveTab('posted')}
                        >
                            My Posted Tasks
                        </a>
                        <a 
                            className={`tab ${activeTab === 'bids' ? 'tab-active' : ''}`}
                            onClick={() => setActiveTab('bids')}
                        >
                            My Bids
                        </a>
                    </div>

                    <div className="bg-base-100 rounded-box shadow-lg p-6">
                        {activeTab === 'posted' ? (
                            tasks.length === 0 ? (
                                <div className="text-center py-12">
                                    <p className="text-base-content/60 mb-4">You haven't posted any tasks yet</p>
                                    <button className="btn btn-primary" onClick={() => window.navigateTo('post')}>
                                        Post Your First Task
                                    </button>
                                </div>
                            ) : (
                                <div className="space-y-4">
                                    {tasks.map(task => (
                                        <div key={task.id} className="flex items-center justify-between p-4 bg-base-200 rounded-lg">
                                            <div className="flex items-center gap-4">
                                                <div className={`w-3 h-3 rounded-full ${task.status === 'open' ? 'bg-success' : task.status === 'in-progress' ? 'bg-warning' : 'bg-info'}`}></div>
                                                <div>
                                                    <h4 className="font-semibold">{task.title}</h4>
                                                    <p className="text-sm text-base-content/60">{task.bids?.length || 0} bids ‚Ä¢ ${task.budget}</p>
                                                </div>
                                            </div>
                                            <div className="flex gap-2">
                                                <button className="btn btn-sm btn-ghost">View</button>
                                                {task.status === 'open' && (
                                                    <button className="btn btn-sm btn-error btn-outline">Close</button>
                                                )}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )
                        ) : (
                            bids.length === 0 ? (
                                <div className="text-center py-12">
                                    <p className="text-base-content/60 mb-4">You haven't placed any bids yet</p>
                                    <button className="btn btn-primary" onClick={() => window.navigateTo('browse')}>
                                        Browse Tasks
                                    </button>
                                </div>
                            ) : (
                                <div className="space-y-4">
                                    {bids.map(task => {
                                        const myBid = task.bids.find(b => b.freelancer === user.email);
                                        return (
                                            <div key={task.id} className="flex items-center justify-between p-4 bg-base-200 rounded-lg">
                                                <div>
                                                    <h4 className="font-semibold">{task.title}</h4>
                                                    <p className="text-sm text-base-content/60">Your bid: ${myBid.amount}</p>
                                                </div>
                                                <div className="badge badge-outline">
                                                    {task.assignedTo === user.email ? 'Awarded' : 'Pending'}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            )
                        )}
                    </div>
                </div>
            );
        };

        // Post Task Page
        const PostTask = () => {
            const { user } = useAuth();
            const [formData, setFormData] = useState({
                title: '',
                description: '',
                category: 'Web Development',
                budget: '',
                deadline: '',
                skills: '',
                location: 'Remote'
            });
            const [submitting, setSubmitting] = useState(false);
            const [success, setSuccess] = useState(false);

            const categories = [
                'Web Development',
                'Mobile Development',
                'Design',
                'Writing',
                'Marketing',
                'Data Entry',
                'Customer Support',
                'Other'
            ];

            const handleSubmit = async (e) => {
                e.preventDefault();
                setSubmitting(true);
                
                try {
                    await mockFirebase.firestore.collection('tasks').add({
                        ...formData,
                        budget: parseInt(formData.budget),
                        skills: formData.skills.split(',').map(s => s.trim()),
                        status: 'open',
                        postedBy: user.email,
                        postedByName: user.displayName,
                        postedByPhoto: user.photoURL,
                        bids: []
                    });
                    
                    setSuccess(true);
                    setTimeout(() => {
                        window.navigateTo('dashboard');
                    }, 2000);
                } catch (error) {
                    console.error('Error posting task:', error);
                } finally {
                    setSubmitting(false);
                }
            };

            if (success) {
                return (
                    <div className="container mx-auto px-4 py-20 text-center animate-slide-in">
                        <div className="text-6xl mb-4">üéâ</div>
                        <h2 className="text-3xl font-bold mb-4">Task Posted Successfully!</h2>
                        <p className="text-base-content/60 mb-8">Redirecting to your dashboard...</p>
                        <progress className="progress progress-primary w-56"></progress>
                    </div>
                );
            }

            return (
                <div className="container mx-auto px-4 py-8 max-w-2xl animate-slide-in">
                    <h2 className="text-3xl font-bold mb-2">Post a New Task</h2>
                    <p className="text-base-content/60 mb-8">Describe your project and find the perfect freelancer</p>

                    <form onSubmit={handleSubmit} className="space-y-6 bg-base-100 p-8 rounded-box shadow-lg border border-base-200">
                        <div className="form-control">
                            <label className="label">
                                <span className="label-text font-semibold">Task Title</span>
                            </label>
                            <input 
                                type="text" 
                                className="input input-bordered" 
                                placeholder="e.g., Build a React E-commerce Site"
                                value={formData.title}
                                onChange={(e) => setFormData({...formData, title: e.target.value})}
                                required
                            />
                        </div>

                        <div className="form-control">
                            <label className="label">
                                <span className="label-text font-semibold">Description</span>
                            </label>
                            <textarea 
                                className="textarea textarea-bordered h-32" 
                                placeholder="Describe your task in detail..."
                                value={formData.description}
                                onChange={(e) => setFormData({...formData, description: e.target.value})}
                                required
                            ></textarea>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="form-control">
                                <label className="label">
                                    <span className="label-text font-semibold">Category</span>
                                </label>
                                <select 
                                    className="select select-bordered"
                                    value={formData.category}
                                    onChange={(e) => setFormData({...formData, category: e.target.value})}
                                >
                                    {categories.map(cat => (
                                        <option key={cat} value={cat}>{cat}</option>
                                    ))}
                                </select>
                            </div>

                            <div className="form-control">
                                <label className="label">
                                    <span className="label-text font-semibold">Budget ($)</span>
                                </label>
                                <input 
                                    type="number" 
                                    className="input input-bordered" 
                                    placeholder="5000"
                                    value={formData.budget}
                                    onChange={(e) => setFormData({...formData, budget: e.target.value})}
                                    required
                                    min="1"
                                />
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="form-control">
                                <label className="label">
                                    <span className="label-text font-semibold">Deadline</span>
                                </label>
                                <input 
                                    type="date" 
                                    className="input input-bordered"
                                    value={formData.deadline}
                                    onChange={(e) => setFormData({...formData, deadline: e.target.value})}
                                    required
                                />
                            </div>

                            <div className="form-control">
                                <label className="label">
                                    <span className="label-text font-semibold">Location</span>
                                </label>
                                <select 
                                    className="select select-bordered"
                                    value={formData.location}
                                    onChange={(e) => setFormData({...formData, location: e.target.value})}
                                >
                                    <option value="Remote">Remote</option>
                                    <option value="On-site">On-site</option>
                                    <option value="Hybrid">Hybrid</option>
                                </select>
                            </div>
                        </div>

                        <div className="form-control">
                            <label className="label">
                                <span className="label-text font-semibold">Required Skills (comma separated)</span>
                            </label>
                            <input 
                                type="text" 
                                className="input input-bordered" 
                                placeholder="React, Node.js, MongoDB, UI Design"
                                value={formData.skills}
                                onChange={(e) => setFormData({...formData, skills: e.target.value})}
                                required
                            />
                        </div>

                        <button 
                            type="submit" 
                            className={`btn btn-primary btn-lg w-full ${submitting ? 'loading' : ''}`}
                            disabled={submitting}
                        >
                            {submitting ? 'Posting...' : 'Post Task'}
                        </button>
                    </form>
                </div>
            );
        };

        // Auth Pages
        const Login = () => {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);
            const { login } = useAuth();

            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);
                
                try {
                    await login(email, password);
                    window.navigateTo('dashboard');
                } catch (err) {
                    setError(err.message);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/5 p-4">
                    <div className="card w-full max-w-md bg-base-100 shadow-2xl animate-slide-in">
                        <div className="card-body p-8">
                            <div className="text-center mb-8">
                                <h2 className="text-3xl font-bold gradient-text mb-2">Welcome Back</h2>
                                <p className="text-base-content/60">Sign in to continue to TaskMarket</p>
                            </div>

                            {error && (
                                <div className="alert alert-error mb-4">
                                    <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                    <span>{error}</span>
                                </div>
                            )}

                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div className="form-control">
                                    <label className="label">
                                        <span className="label-text">Email</span>
                                    </label>
                                    <input 
                                        type="email" 
                                        className="input input-bordered" 
                                        placeholder="you@example.com"
                                        value={email}
                                        onChange={(e) => setEmail(e.target.value)}
                                        required
                                    />
                                </div>

                                <div className="form-control">
                                    <label className="label">
                                        <span className="label-text">Password</span>
                                        <a href="#" className="label-text-alt link link-hover">Forgot password?</a>
                                    </label>
                                    <input 
                                        type="password" 
                                        className="input input-bordered" 
                                        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        required
                                    />
                                </div>

                                <button 
                                    type="submit" 
                                    className={`btn btn-primary w-full ${loading ? 'loading' : ''}`}
                                    disabled={loading}
                                >
                                    Sign In
                                </button>
                            </form>

                            <div className="divider">OR</div>

                            <p className="text-center text-sm">
                                Don't have an account?{' '}
                                <a href="#" className="link link-primary font-semibold" onClick={() => window.navigateTo('signup')}>
                                    Sign up
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        const Signup = () => {
            const [formData, setFormData] = useState({
                displayName: '',
                email: '',
                password: '',
                confirmPassword: ''
            });
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);
            const { signup } = useAuth();

            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');

                if (formData.password !== formData.confirmPassword) {
                    setError('Passwords do not match');
                    return;
                }

                if (formData.password.length < 6) {
                    setError('Password must be at least 6 characters');
                    return;
                }

                setLoading(true);
                
                try {
                    await signup(formData.email, formData.password, formData.displayName);
                    window.navigateTo('dashboard');
                } catch (err) {
                    setError(err.message);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/5 p-4">
                    <div className="card w-full max-w-md bg-base-100 shadow-2xl animate-slide-in">
                        <div className="card-body p-8">
                            <div className="text-center mb-8">
                                <h2 className="text-3xl font-bold gradient-text mb-2">Create Account</h2>
                                <p className="text-base-content/60">Join thousands of freelancers and clients</p>
                            </div>

                            {error && (
                                <div className="alert alert-error mb-4">
                                    <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                    <span>{error}</span>
                                </div>
                            )}

                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div className="form-control">
                                    <label className="label">
                                        <span className="label-text">Full Name</span>
                                    </label>
                                    <input 
                                        type="text" 
                                        className="input input-bordered" 
                                        placeholder="John Doe"
                                        value={formData.displayName}
                                        onChange={(e) => setFormData({...formData, displayName: e.target.value})}
                                        required
                                    />
                                </div>

                                <div className="form-control">
                                    <label className="label">
                                        <span className="label-text">Email</span>
                                    </label>
                                    <input 
                                        type="email" 
                                        className="input input-bordered" 
                                        placeholder="you@example.com"
                                        value={formData.email}
                                        onChange={(e) => setFormData({...formData, email: e.target.value})}
                                        required
                                    />
                                </div>

                                <div className="form-control">
                                    <label className="label">
                                        <span className="label-text">Password</span>
                                    </label>
                                    <input 
                                        type="password" 
                                        className="input input-bordered" 
                                        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                        value={formData.password}
                                        onChange={(e) => setFormData({...formData, password: e.target.value})}
                                        required
                                    />
                                </div>

                                <div className="form-control">
                                    <label className="label">
                                        <span className="label-text">Confirm Password</span>
                                    </label>
                                    <input 
                                        type="password" 
                                        className="input input-bordered" 
                                        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                        value={formData.confirmPassword}
                                        onChange={(e) => setFormData({...formData, confirmPassword: e.target.value})}
                                        required
                                    />
                                </div>

                                <button 
                                    type="submit" 
                                    className={`btn btn-primary w-full ${loading ? 'loading' : ''}`}
                                    disabled={loading}
                                >
                                    Create Account
                                </button>
                            </form>

                            <div className="divider">OR</div>

                            <p className="text-center text-sm">
                                Already have an account?{' '}
                                <a href="#" className="link link-primary font-semibold" onClick={() => window.navigateTo('login')}>
                                    Sign in
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            const [currentPage, setCurrentPage] = useState('home');
            const { user } = useAuth();

            // Navigation helper
            window.navigateTo = (page) => {
                setCurrentPage(page);
                window.scrollTo(0, 0);
            };

            // Protected route helper
            const ProtectedRoute = ({ children }) => {
                if (!user) {
                    return <Login />;
                }
                return children;
            };

            const renderPage = () => {
                switch(currentPage) {
                    case 'home':
                        return (
                            <>
                                <Hero />
                                <div className="container mx-auto px-4 py-16">
                                    <h2 className="text-3xl font-bold text-center mb-12">Featured Tasks</h2>
                                    <BrowseTasks />
                                </div>
                                <div className="bg-base-200 py-16">
                                    <div className="container mx-auto px-4 text-center">
                                        <h2 className="text-3xl font-bold mb-8">How It Works</h2>
                                        <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                            <div className="card bg-base-100 p-6">
                                                <div className="text-4xl mb-4">üìù</div>
                                                <h3 className="text-xl font-bold mb-2">Post a Task</h3>
                                                <p className="text-base-content/60">Describe what you need done and set your budget</p>
                                            </div>
                                            <div className="card bg-base-100 p-6">
                                                <div className="text-4xl mb-4">ü§ù</div>
                                                <h3 className="text-xl font-bold mb-2">Review Bids</h3>
                                                <p className="text-base-content/60">Compare proposals and choose the best freelancer</p>
                                            </div>
                                            <div className="card bg-base-100 p-6">
                                                <div className="text-4xl mb-4">‚úÖ</div>
                                                <h3 className="text-xl font-bold mb-2">Get It Done</h3>
                                                <p className="text-base-content/60">Collaborate and pay only when satisfied</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </>
                        );
                    case 'browse':
                        return <BrowseTasks />;
                    case 'dashboard':
                        return <ProtectedRoute><Dashboard /></ProtectedRoute>;
                    case 'post':
                        return <ProtectedRoute><PostTask /></ProtectedRoute>;
                    case 'login':
                        return user ? <Dashboard /> : <Login />;
                    case 'signup':
                        return user ? <Dashboard /> : <Signup />;
                    case 'profile':
                        return <ProtectedRoute><Dashboard /></ProtectedRoute>;
                    default:
                        return <Hero />;
                }
            };

            return (
                <div className="min-h-screen bg-base-100">
                    {currentPage !== 'login' && currentPage !== 'signup' && <Navbar />}
                    <main className="pb-20">
                        <Suspense fallback={<LoadingSpinner />}>
                            {renderPage()}
                        </Suspense>
                    </main>
                    {currentPage !== 'login' && currentPage !== 'signup' && (
                        <footer className="bg-base-200 py-8 mt-20">
                            <div className="container mx-auto px-4 text-center text-base-content/60">
                                <p>¬© 2026 TaskMarket. All rights reserved.</p>
                            </div>
                        </footer>
                    )}
                </div>
            );
        };

        // Root Render
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <ErrorBoundary>
                <ThemeProvider>
                    <AuthProvider>
                        <App />
                    </AuthProvider>
                </ThemeProvider>
            </ErrorBoundary>
        );
    </script>
</body>
</html>